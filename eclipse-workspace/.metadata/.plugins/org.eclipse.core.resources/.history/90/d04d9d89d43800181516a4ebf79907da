package org.androidtown.socket;

import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.net.InetAddress;
import java.net.ServerSocket;
import java.net.Socket;

public class SocketServer 
{
	public static void main(final String[] args)
	{
	try
	{
		final int portNumber = 5001;
		
		System.out.println("Starting Java Socket Server ...");
		final ServerSocket aServerSocket = new ServerSocket(portNumber); //객체 생성
		System.out.println("Listening at port " + portNumber + " ...");
		
		while(true)//클라이언트 연결 대기
		{
			final Socket sock = aServerSocket.accept();//소켓 객체 참조
			final InetAddress clientHost = sock.getLocalAddress();
			final int clientPort = sock.getPort();
			System.out.println("A client connected. host : " + clientHost + ", port : " + clientPort);
			
			final DataInputStream inStream = new DataInputStream(sock.getInputStream());
			final DataOutputStream outStream = new DataOutputStream(sock.getOutputStream());
			
			while(true)
			{
				try
				{
					System.out.printf("Server Received %s\n", DataInputStream.readUTF() );
				}
				catch(Exception ex)
				{
					
				}
			}
			
			outStream.flush();
			sock.close();
		}
	}
	catch(final Exception ex)
	{
		ex.printStackTrace();
	}
	}
}
